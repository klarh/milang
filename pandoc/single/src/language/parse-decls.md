[Header 1 ("parse-declarations-", [], []) [Str "Parse Declarations (", Code ("", [], []) ":!", Str ")"], Para [Str "The ", Code ("", [], []) ":!", Str " annotation domain declares how the parser should handle a user-defined operator — specifically its precedence and associativity. The parser pre-scans the source for ", Code ("", [], []) ":!", Str " declarations before parsing expressions, so they take effect immediately."], Header 2 ("syntax", ["unnumbered", "unlisted"], []) [Str "Syntax"], CodeBlock ("", ["milang"], []) "(op) :! {prec = N; assoc = Left}
", BulletList [[Plain [Strong [Code ("", [], []) "prec"], Str " — an integer precedence level. Higher values bind more tightly."]], [Plain [Strong [Code ("", [], []) "assoc"], Str " — one of ", Code ("", [], []) "Left", Str ", ", Code ("", [], []) "Right", Str ", or ", Code ("", [], []) "None", Str ". Determines how chains of the same operator group:"], BulletList [[Plain [Code ("", [], []) "Left", Str ": ", Code ("", [], []) "a op b op c", Str " parses as ", Code ("", [], []) "(a op b) op c"]], [Plain [Code ("", [], []) "Right", Str ": ", Code ("", [], []) "a op b op c", Str " parses as ", Code ("", [], []) "a op (b op c)"]], [Plain [Code ("", [], []) "None", Str ": chaining is a parse error; explicit parentheses are required."]]]]], Header 2 ("example", ["unnumbered", "unlisted"], []) [Str "Example"], CodeBlock ("", ["milang"], []) "(<=>) :! {prec = 30; assoc = Left}
(<=>) a b = if (a == b) 0 (if (a > b) 1 (0 - 1))

cmp1 = 5 <=> 3
cmp2 = 3 <=> 3
cmp3 = 1 <=> 5
", CodeBlock ("", [""], []) "<=> = <closure>
cmp1 = 1
cmp2 = 0
cmp3 = -1
", Header 2 ("built-in-operator-precedences", ["unnumbered", "unlisted"], []) [Str "Built-in Operator Precedences"], Para [Str "For reference, the approximate precedence levels of built-in operators:"], Table ("", [], []) (Caption Nothing []) [(AlignDefault, ColWidthDefault), (AlignDefault, ColWidthDefault), (AlignDefault, ColWidthDefault)] (TableHead ("", [], []) [Row ("", [], []) [Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Precedence"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Operators"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Associativity"]]]]) [(TableBody ("", [], []) (RowHeadColumns 0) [] [Row ("", [], []) [Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "1"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Code ("", [], []) "|>", Str " ", Code ("", [], []) ">>", Str " ", Code ("", [], []) "<<"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Left"]]], Row ("", [], []) [Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "2"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Code ("", [], []) "||"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Left"]]], Row ("", [], []) [Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "3"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Code ("", [], []) "&&"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Left"]]], Row ("", [], []) [Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "4"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Code ("", [], []) "==", Str " ", Code ("", [], []) "/=", Str " ", Code ("", [], []) "<", Str " ", Code ("", [], []) ">", Str " ", Code ("", [], []) "<=", Str " ", Code ("", [], []) ">="]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Left"]]], Row ("", [], []) [Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "5"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Code ("", [], []) ":"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Right"]]], Row ("", [], []) [Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "6"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Code ("", [], []) "+", Str " ", Code ("", [], []) "-", Str " ", Code ("", [], []) "++"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Left"]]], Row ("", [], []) [Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "7"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Code ("", [], []) "*", Str " ", Code ("", [], []) "/", Str " ", Code ("", [], []) "%"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Left"]]], Row ("", [], []) [Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "8"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Code ("", [], []) "**"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Right"]]]])] (TableFoot ("", [], []) []), Para [Str "User-defined operators without a ", Code ("", [], []) ":!", Str " declaration receive a default precedence. Define ", Code ("", [], []) ":!", Str " to override this and integrate your operator naturally with built-in ones."], Header 2 ("metaprogramming-hook", ["unnumbered", "unlisted"], []) [Str "Metaprogramming Hook"], Para [Str "Because ", Code ("", [], []) ":!", Str " declarations are processed during parsing (before evaluation), they serve as a metaprogramming hook — they let you reshape how the parser reads subsequent expressions. Combined with user-defined operators, this gives you control over the syntactic structure of your programs."]]