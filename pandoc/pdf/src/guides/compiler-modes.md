[Header 1 ("compiler-modes", [], []) [Str "Compiler Modes"], Para [Str "The ", Code ("", [], []) "milang", Str " binary supports six commands. Each operates on a ", Code ("", [], []) ".mi", Str " source file and exercises different parts of the compilation pipeline."], Header 2 ("milang-run", ["unnumbered", "unlisted"], []) [Code ("", [], []) "milang run"], CodeBlock ("", ["bash"], []) "./milang run file.mi
", Para [Str "The most common command. It parses the file, resolves imports, partially evaluates, generates C, compiles with ", Code ("", [], []) "gcc -O2", Str ", runs the resulting binary, and cleans up temporary files."], Para [Str "If the file defines ", Code ("", [], []) "main world = ...", Str ", the program runs as a normal executable and ", Code ("", [], []) "main", Str "'s return value becomes the process exit code. If there is no ", Code ("", [], []) "main", Str " binding with a parameter, milang runs in ", Strong [Str "script mode"], Str " (see below)."], Header 3 ("example", ["unnumbered", "unlisted"], []) [Str "Example"], CodeBlock ("", ["milang"], []) "main world =
  world.io.println \"running!\"
", CodeBlock ("", [""], []) "running!
", Header 2 ("milang-compile", ["unnumbered", "unlisted"], []) [Code ("", [], []) "milang compile"], CodeBlock ("", ["bash"], []) "./milang compile file.mi            # writes file.c
./milang compile file.mi output.c   # writes output.c
./milang compile file.mi -          # prints C to stdout
", Para [Str "Emits a self-contained C source file. The milang runtime is embedded in the output, so the generated file has no external dependencies beyond the standard C library."], Para [Str "Compile it yourself:"], CodeBlock ("", ["bash"], []) "gcc output.c -o program
./program
", Para [Str "This is useful when you want to inspect the generated code, cross-compile, or integrate milang output into a larger C project."], Header 2 ("milang-dump", ["unnumbered", "unlisted"], []) [Code ("", [], []) "milang dump"], CodeBlock ("", ["bash"], []) "./milang dump file.mi
", Para [Str "Prints the ", Strong [Str "parsed AST"], Str " before import resolution or partial evaluation. This shows you exactly how the parser interpreted your source, including all five annotation domains (", Code ("", [], []) "=", Str ", ", Code ("", [], []) "::", Str ", ", Code ("", [], []) ":~", Str ", ", Code ("", [], []) ":?", Str ", ", Code ("", [], []) ":!", Str ")."], Para [Str "Use this to debug syntax issues — if the parser grouped your expressions differently than you expected, ", Code ("", [], []) "dump", Str " will show it."], Header 2 ("milang-reduce", ["unnumbered", "unlisted"], []) [Code ("", [], []) "milang reduce"], CodeBlock ("", ["bash"], []) "./milang reduce file.mi
", Para [Str "Prints the AST ", Strong [Str "after partial evaluation"], Str ". This is what the code generator actually sees. Any expression that could be computed at compile time has been reduced to a literal value."], Para [Str "Use this to verify that the partial evaluator is doing what you expect:"], CodeBlock ("", ["milang"], []) "square x = x * 2
answer = square 21
", CodeBlock ("", [""], []) "square = <closure>
answer = 42
", Para [Str "Running ", Code ("", [], []) "milang reduce", Str " on this file would show ", Code ("", [], []) "answer = 42", Str " — the function call was evaluated at compile time."], Para [Str "If you need to see reduction without the prelude injected, use ", Code ("", [], []) "milang raw-reduce file.mi", Str " to view the reduced AST for the file alone."], Header 2 ("milang-pin", ["unnumbered", "unlisted"], []) [Code ("", [], []) "milang pin"], CodeBlock ("", ["bash"], []) "./milang pin file.mi
", Para [Str "Finds all URL imports in the file, fetches them, computes a Merkle hash (SHA-256 of the content plus all transitive sub-imports), and rewrites the source file to include the hash:"], Para [Str "Before:"], CodeBlock ("", ["milang"], []) "utils = import \"https://example.com/utils.mi\"
", Para [Str "After:"], CodeBlock ("", ["milang"], []) "utils = import' \"https://example.com/utils.mi\" ({sha256 = \"a1b2c3...\"})
", Para [Str "This ensures that the imported code hasn't changed since you ", Code ("", [], []) "last", Str " pinned it. If the content changes, the compiler will report a hash mismatch and refuse to proceed."], Header 2 ("milang-repl", ["unnumbered", "unlisted"], []) [Code ("", [], []) "milang repl"], CodeBlock ("", ["bash"], []) "./milang repl
", Para [Str "Starts an interactive REPL where you can evaluate expressions and define bindings. See the ", Link ("", [], []) [Str "REPL"] ("/home/matthew/dev/milang-copilot/docs-out/pandoc/pdf/src/guides/repl.md#repl", ""), Str " chapter for details."], Header 2 ("script-mode", ["unnumbered", "unlisted"], []) [Str "Script Mode"], Para [Str "When a ", Code ("", [], []) ".mi", Str " file has no ", Code ("", [], []) "main", Str " binding that takes a parameter, ", Code ("", [], []) "milang run", Str " operates in ", Strong [Str "script mode"], Str ": it evaluates every top-level binding and prints each name-value pair."], CodeBlock ("", ["milang"], []) "a = 2 + 3
b = a * a
greeting = \"hello\"
", CodeBlock ("", [""], []) "a = 5
b = 25
greeting = hello
", Para [Str "Script mode is ideal for quick calculations and testing small snippets. Prelude definitions are automatically hidden from the output."], Header 2 ("security-flags", ["unnumbered", "unlisted"], []) [Str "Security Flags"], Para [Str "Milang supports flags to restrict what imported code can do (note: these flags are not currently implemented in the core compiler; see .github/ROADMAP.md):"], Table ("", [], []) (Caption Nothing []) [(AlignDefault, (ColWidth 0.42857142857142855)), (AlignDefault, (ColWidth 0.5714285714285714))] (TableHead ("", [], []) [Row ("", [], []) [Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Flag"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Effect"]]]]) [(TableBody ("", [], []) (RowHeadColumns 0) [] [Row ("", [], []) [Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Code ("", [], []) "--no-ffi"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Disables all C FFI imports (no ", Code ("", [], []) ".h", Str " files can be imported)"]]], Row ("", [], []) [Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Code ("", [], []) "--no-remote-ffi"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Disallows C FFI for remote (URL) imports specifically"]]]])] (TableFoot ("", [], []) []), Para [Str "These flags are useful when running untrusted code. A URL import might try to ", Code ("", [], []) "import \"/usr/include/stdlib.h\"", Str " and call arbitrary C functions — ", Code ("", [], []) "--no-remote-ffi", Str " prevents this while still allowing your own local FFI usage."], Header 2 ("summary", ["unnumbered", "unlisted"], []) [Str "Summary"], Table ("", [], []) (Caption Nothing []) [(AlignDefault, ColWidthDefault), (AlignDefault, ColWidthDefault)] (TableHead ("", [], []) [Row ("", [], []) [Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Command"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "What it does"]]]]) [(TableBody ("", [], []) (RowHeadColumns 0) [] [Row ("", [], []) [Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Code ("", [], []) "run file.mi"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Compile and execute"]]], Row ("", [], []) [Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Code ("", [], []) "compile file.mi [out.c]"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Emit standalone C"]]], Row ("", [], []) [Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Code ("", [], []) "dump file.mi"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Show parsed AST"]]], Row ("", [], []) [Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Code ("", [], []) "reduce file.mi"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Show partially-evaluated AST"]]], Row ("", [], []) [Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Code ("", [], []) "pin file.mi"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Fetch URL imports, write SHA-256 hashes"]]], Row ("", [], []) [Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Code ("", [], []) "repl"]], Cell ("", [], []) AlignDefault (RowSpan 0) (ColSpan 0) [Plain [Str "Interactive evaluation"]]]])] (TableFoot ("", [], []) [])]